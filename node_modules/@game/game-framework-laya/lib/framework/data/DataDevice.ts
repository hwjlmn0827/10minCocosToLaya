import {DataBase} from './DataBase';

/**
 * 设备数据类
 * Rainbow启动都监听getSystemInfoSuccess消息，回调后可以调用方法才可以得到正确的值
 */
export default class DataDevice extends DataBase {
  protected constructor() {
    super();
  }

  private static _instance: DataDevice;

  static getInstance(): DataDevice {
    if (!this._instance) {
      this._instance = new DataDevice();
    }
    return this._instance;
  }

  /**
   * 返回设备品牌
   */
  public getBrand(): string {
    return this._data.brand;
  }

  /**
   * 返回型号
   */
  public getModel(): string {
    return this._data.model;
  }

  /**
   * 返回像素比
   */
  public getPixelRatio(): number {
    return this._data.pixelRatio;
  }

  /**
   * 返回屏幕宽度，单位px
   */
  public getScreenWidth(): number {
    return this._data.screenWidth;
  }

  /**
   * 返回屏幕高度，单位px
   */
  public getScreenHeight(): number {
    return this._data.screenHeight;
  }

  /**
   * 返回可使用窗口宽度，单位px
   */
  public getWindowWidth(): number {
    return this._data.windowWidth;
  }

  /**
   * 返回可使用窗口高度，单位px
   */
  public getWindowHeight(): number {
    return this._data.widowHeight;
  }

  /**
   * 返回状态栏的高度，单位px
   */
  public getStatusBarHeight(): number {
    return this._data.statusBarHeight;
  }

  /**
   * 返回美团设置的语言
   */
  public getLanguage(): string {
    return this._data.language;
  }

  /**
   * 返回美团版本号
   */
  public getVersion(): string {
    return this._data.version;
  }

  /**
   * 返回操作系统及版本
   */
  public getSystem(): string {
    return this._data.system;
  }

  /**
   * 返回客户端平台
   * 返回值为小写 (ios/android)
   */
  public getPlatform(): string {
    let platform = this._data.platform;
    if (platform) {
      return (platform as string).toLowerCase();
    }
    return 'unkown';
  }

  /**
   * 返回客户端基础库版本
   */
  public getSDKVersion(): string {
    return this._data.SDKVersion;
  }

  /**
   * 设置mgcId
   * @param mgcId
   */
  public setMgcId(mgcId: string) {
    this._data.mgcId = mgcId;
  }

  /**
   * 返回mgcId 小游戏用户唯一id
   * 不存在则为null
   */
  public getMgcId(): string {
    return this._data.mgcId;
  }

  /**
   * 设置美团UserId
   * @param mtUserId
   */
   public setMtUserId(mtUserId: string){
    this._data.mtUserId = mtUserId;
  }

  /**
   * 返回美团UserId
   * 需要调用LoginSDK.getInstance().login的回调后才能正常获取值
   * 美团11.7.200及以上支持
   * 未支持时返回null
   */
  public getMtUserId(): string {
    return this._data.mtUserId;
  }

  /**
   * 设置美团token
   * @param mtToken
   */
  public setMtToken(mtToken:string){
    this._data.mtToken = mtToken;
  }

  /**
   * 返回美团token
   * 需要调用LoginSDK.getInstance().login的回调后才能正常获取值
   * 美团11.7.200及以上支持
   * 未支持时返回null
   */
  public getMtToken():string{
    return this._data.mtToken;
  }

  /**
   * 返回 uuid
   * 美团版本11.3.200支持，未支持时返回null
   */
  public getUuid(): string {
    return this._data.uuid;
  }

  /**
   * 此值一般情况下无用，设备标识应该是用uuid
   * 仅android
   * 11.3.200支持
   */
  public getDeviceId(): string{
    return this._data.deviceId
  }

  /**
   * 返回指纹
   * 11.3.200支持
   */
  public getFingerprint(): string {
    return this._data.fingerprint;
  }

  /**
   * 返回首页选择城市ID
   * 11.3.400支持
   */
  public getCityId(): string {
    return this._data.cityId;
  }

  /**
   * 返回定位城市ID
   * 11.3.200支持
   */
  public getLocalCityId(): string {
    return this._data.localId;
  }

  /**
   * 返回游戏版本号
   * 11.3.200支持
   */
  public getGameVersion(): string {
    return this._data.gameVersion || '';
  }

  /**
   * 返回AppId
   * 11.3.200支持
   */
  public getAppId(): string {    
    return this._data.appId || process.env.appId;
  }

  /**
   * 返回AppName
   * 11.3.200支持
   */
  public getAppName(): string {
    return this._data.appName;
  }

  /**
   * 返回是否正在提审
   * 仅iOS有效
   * 11.7.200支持
   */
  public isPreview(): boolean {
    return this._data.preview || false;
  }

  /**
   * 返回IDFA值
   * 仅iOS有效
   * 11.3.200支持
   */
  public getIdfa(){
    return this._data.idfa;
  }

  /**
   * 返回IDFV值
   * 仅iOS有效
   * 11.3.200支持
   */
  public getIdfv(){
    return this._data.idfv;
  }

  /**
   * 返回IMEI值
   * 仅Android有效
   * 11.3.200支持
   */
  public getImei(){
    return this._data.imei;
  }

  /**
   * 返回容器宿主，默认返回为'meituan'
   * 目前还没有对web游戏适配处理，只支持小游戏
   * 11.20.200支持
   */
  public getAppType(){
    return this._data.appType || 'meituan';
  }
}
